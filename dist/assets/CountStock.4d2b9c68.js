import{d as ke,a as k,u as M,b as be,e as H,r as b,o as ge,H as we,f as g,g as J,h as u,i as f,j as o,k as t,w as n,l as _,m as e,_ as w,I as P,q as h,t as Y,F as A,s as E,v as m,A as R,V as xe,n as Z,W as x,C as ee,D as v,z as U,L as Ce,x as te,B as se,S as L,E as ae,G as oe,O as le}from"./index.62cb36ac.js";const ne="http://garage_api.test/api/",Se=ke({id:"CountStockStore",state:()=>({ItemDetail:[],ItemEdit:[],Details:[],SysdocDetails:[],Stock:[],Product:[],UNA_Combo:[]}),getters:{getItemsDetail(i){return i.ItemDetail},getItemsById(i){return i.ItemEdit},getStock(i){return i.Stock},getProduct(i){return i.Product},getSysdocDetails(i){return i.SysdocDetails},getUNACombo(i){return i.UNA_Combo}},actions:{async cboStockList(){await k.get("v1/pos/combo/pos_stock").then(i=>{this.Stock=i.data.data}).catch(i=>{if(i.response&&i.response.data){const s=i.response.data;M().setErrors(s.errors)}})},async combo_una_list(){await k.get("v1/pos/una_count_list").then(i=>{if(i.data.success)return this.UNA_Combo=i.data.data,this.UNA_Combo})},async search_items(i){await k.get(`v1/pos/search_items/${i}`).then(s=>{this.Product=s.data.data})},async una_details_sysdoc(i){await k.get(`v1/pos/una_count_stock_sysdoc/${i}`).then(s=>{if(s.data.success)return this.SysdocDetails=s.data.data,this.SysdocDetails})},async create_details(i){return await k.post(ne+"v1/pos/create_count_stock_details",i).then(async s=>{if(s.data.success)return s.data.success}).catch(s=>{if(s.response&&s.response.data){const c=s.response.data;M().setErrors(c.errors)}})},async create_trans(i){return await k.post(ne+"v1/pos/create_count_stock",i).then(async s=>{if(s.data.success)return s.data.success}).catch(s=>{if(s.response&&s.response.data){const c=s.response.data;M().setErrors(c.errors)}})},async una_tran_by_id(i){await k.get(`v1/pos/una_count_list/${i}`).then(s=>{if(s.data.success)return this.ItemEdit=s.data.data,this.ItemEdit})},async una_details_id(i){await k.get(`v1/pos/una_count_stock_id/${i}`).then(s=>{if(s.data.success)return this.ItemDetail=s.data.data,this.ItemDetail})}}}),$e={class:"flex flex-col items-center mt-8 intro-y sm:flex-row"},De=o("h2",{class:"mr-auto text-lg font-medium"},"Count Stock",-1),Ie={class:"flex w-full mt-4 sm:w-auto sm:mt-0"},qe={class:"flex items-center justify-center w-5 h-5"},Ve={class:"truncate"},Fe={class:"grid grid-cols-12 gap-5 mt-5 intro-y"},Ne={class:"col-span-12 intro-y lg:col-span-8"},Te={class:"lg:flex intro-y"},Pe={class:"relative"},Ae={class:"grid grid-cols-12 gap-5 mt-5"},Ee=["onClick"],Ue={class:"text-base font-medium"},Le={class:"text-slate-500"},Be={class:"pr-1 intro-y"},Oe={class:"p-2 box"},Me={key:0,class:"p-2 mt-5 box"},Re=["onClick"],We={class:"max-w-[50%] truncate mr-1"},ze={class:"text-slate-500"},Ke={key:1,class:"p-5 mt-5 box"},je=o("div",{class:"flex"},[o("div",{class:"mr-auto"},"Waitting transaction order")],-1),Ge=[je],Qe={class:"flex mt-5"},Xe={key:0,class:"p-5 mt-5 box"},He=o("div",{class:"mr-auto"},"No infomation details",-1),Je=[He],Ye={key:1,class:"p-5 mt-5 box"},Ze={class:"flex items-center pb-5 border-b border-slate-200 dark:border-darkmode-400"},et=o("div",{class:"text-slate-500"},"Time",-1),tt={class:"mt-1"},st={class:"flex items-center py-5 border-b border-slate-200 dark:border-darkmode-400"},at=o("div",{class:"text-slate-500"},"Stock",-1),ot={class:"mt-1"},lt={class:"flex items-center py-5 border-b border-slate-200 dark:border-darkmode-400"},nt=o("div",{class:"text-slate-500"},"Remark",-1),rt={class:"mt-1"},it=o("div",{class:"ml-4 mr-4"},[o("div",{class:"font-medium"},"Registration success!")],-1),ct=o("div",{class:"ml-4 mr-4"},[o("div",{class:"mt-1 text-slate-500"},"Please check the fileld form.")],-1),dt=o("h2",{class:"mr-auto text-base font-medium"},"Count Stock info",-1),ut={class:"col-span-12"},_t=["value"],mt={class:"col-span-12"},ft={class:"mr-auto text-base font-medium"},vt={class:"col-span-12 sm:col-span-6"},pt={class:"col-span-12"},ht={class:"p-5 text-center"},yt=o("div",{class:"mt-5 text-3xl"},"Invalid Ticket",-1),kt=o("div",{class:"mt-2 text-slate-500"}," Please create your ticket first ! ",-1),bt={class:"px-5 pb-8 text-center"},wt=be({__name:"CountStock",setup(i){const s=Se(),c=H({}),r=H({}),I=b("0"),S=b(""),W=b(!1),q=d=>{X(),W.value=d},z=b(!1),V=d=>{r.tran_code==""||r.tran_code==null?F(!0):z.value=d};b(!1);const K=b(!1),F=d=>{K.value=d},j=b(null),G=b(null);ge(async()=>{await s.search_items("all"),await s.combo_una_list(),await s.cboStockList(),await B("0000"),N(),T()}),we(I,()=>{c.stc_code=I.value});const re=g(()=>s.getStock),Q=g(()=>s.getUNACombo),C=g(()=>s.getItemsById),ie=g(()=>s.getProduct),p=g(()=>s.getItemsDetail),$=g(()=>s.getSysdocDetails),ce=g(()=>({stc_code:{required:ae.withMessage("Transfer from stock is required",oe),minLength:le(1)}})),y=J(ce,c,{$autoDirty:!0});function N(){c.branch_code="",c.tran_code="",c.stc_code="",c.remark="",c.inputter="",y.value.$reset(),c.status="i"}function T(){r.status="i",r.pro_code="",r.barcode="",r.qty=0,r.remark="",D.value.$reset()}async function de(){if(y.value.$touch(),y.value.$invalid){const a=document.querySelectorAll("#failed-notification-content")[0].cloneNode(!0);a.classList.remove("hidden"),L({node:a,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast()}else{var d=await s.create_trans(c);if(d){const a=document.querySelectorAll("#success-notification-content")[0].cloneNode(!0);a.classList.remove("hidden"),L({node:a,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast(),await s.combo_una_list(),q(!1),N(),y.value.$reset()}}}async function ue(d){await s.una_tran_by_id(d),console.log(C.value),c.status="cm",c.tran_code=C.value[0].tran_code,c.stc_code=C.value[0].stc_code,c.stock_name=C.value[0].stock_name,c.remark=C.value[0].remark,c.input_date=C.value[0].input_date,r.status="i",r.tran_code=C.value[0].tran_code,B(r.tran_code)}async function _e(){S.value==""||S.value==null?await s.search_items("all"):await s.search_items(S.value)}async function me(d){T(),r.pro_code=d}async function fe(d){const a=["0","1","2","3","4","5","6","7","8","9","."],l=d.key;a.includes(l)||d.preventDefault()}const ve=g(()=>({qty:{required:ae.withMessage("Qty is required",oe),minLength:le(1)}})),D=J(ve,r,{$autoDirty:!0});async function pe(){if(D.value.$touch(),r.tran_code==""||r.tran_code==null)F(!0);else if(D.value.$invalid){const a=document.querySelectorAll("#failed-notification-content")[0].cloneNode(!0);a.classList.remove("hidden"),L({node:a,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast()}else{var d=await s.create_details(r);if(d){const a=document.querySelectorAll("#success-notification-content")[0].cloneNode(!0);a.classList.remove("hidden"),L({node:a,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast(),q(!1),V(!1),N(),T(),y.value.$reset(),D.value.$reset(),await s.combo_una_list(),await B(r.tran_code)}}}async function B(d){await s.una_details_id(d),p.value.length>0&&(r.status="i",r.tran_code=p.value[0].tran_code,r.pro_code=p.value[0].pro_code,r.pro_name=p.value[0].pro_name,r.barcode=p.value[0].barcode,r.qty=p.value[0].qty)}async function he(d){await s.una_details_sysdoc(d),r.status="i",$.value.length>0&&(r.tran_code=$.value[0].tran_code,r.pro_code=$.value[0].pro_code,r.barcode=$.value[0].barcode,r.qty=$.value[0].qty,r.remark=$.value[0].remark)}function X(){N(),T(),s.$reset(),s.combo_una_list(),s.cboStockList(),s.search_items("all")}return(d,a)=>(u(),f("div",null,[o("div",$e,[De,o("div",Ie,[t(e(w),{id:"btnCreate",as:"a",href:"#",variant:"primary",onClick:a[0]||(a[0]=l=>{l.preventDefault(),q(!0)}),class:"mr-2 shadow-md"},{default:n(()=>[_(" New Order ")]),_:1}),t(e(P),{class:"ml-auto sm:ml-0"},{default:n(()=>[t(e(P).Button,{as:e(w),class:"px-2 !box"},{default:n(()=>[o("span",qe,[t(e(h),{icon:"ChevronDown",class:"w-4 h-4"})])]),_:1},8,["as"]),Q.value.length>0?(u(),Y(e(P).Items,{key:0},{default:n(()=>[(u(!0),f(A,null,E(Q.value,l=>(u(),Y(e(P).Item,{key:l.id,onClick:()=>{ue(l.id)}},{default:n(()=>[t(e(h),{icon:"Printer",class:"w-4 h-4 mr-2"}),o("span",Ve,m(l.name)+"- "+m(l.id),1)]),_:2},1032,["onClick"]))),128))]),_:1})):R("",!0)]),_:1})])]),o("div",Fe,[o("div",Ne,[o("div",Te,[o("div",Pe,[t(e(Z),{type:"text",modelValue:S.value,"onUpdate:modelValue":a[1]||(a[1]=l=>S.value=l),value:S.value,onKeyup:a[2]||(a[2]=xe(l=>_e(),["enter"])),class:"w-full px-4 py-3 pr-10 lg:w-64 !box",placeholder:"Search item..."},null,8,["modelValue","value"]),t(e(h),{icon:"Search",class:"absolute inset-y-0 right-0 w-4 h-4 my-auto mr-3 text-slate-500"})])]),o("div",Ae,[(u(!0),f(A,null,E(ie.value,l=>(u(),f("div",{class:"col-span-12 p-5 cursor-pointer sm:col-span-4 2xl:col-span-3 box zoom-in",onClick:O=>{O.preventDefault(),V(!0),me(l.pro_code)},key:l.pro_code},[o("div",Ue,m(l.pro_name),1),o("div",Le,m(l.barcode),1)],8,Ee))),128))])]),t(e(x).Group,{class:"col-span-12 lg:col-span-4"},{default:n(()=>[o("div",Be,[o("div",Oe,[t(e(x).List,{variant:"pills"},{default:n(()=>[t(e(x),null,{default:n(()=>[t(e(x).Button,{as:"button",class:"w-full py-2"},{default:n(()=>[_(" Ticket ")]),_:1})]),_:1}),t(e(x),null,{default:n(()=>[t(e(x).Button,{as:"button",class:"w-full py-2"},{default:n(()=>[_(" Details ")]),_:1})]),_:1})]),_:1})])]),t(e(x).Panel,null,{default:n(()=>[p.value.length>0?(u(),f("div",Me,[(u(!0),f(A,null,E(p.value,(l,O)=>(u(),f("a",{href:"#",key:l.sysdoc,onClick:ye=>{ye.preventDefault(),V(!0),he(l.sysdoc)},class:"flex items-center p-3 transition duration-300 ease-in-out bg-white rounded-md cursor-pointer dark:bg-darkmode-600 hover:bg-slate-100 dark:hover:bg-darkmode-400"},[o("div",We,m(O+1)+".",1),o("div",ze,m(l.pro_name)+" = "+m(l.qty)+" to "+m(l.stock_name),1),t(e(h),{icon:"Edit",class:"w-4 h-4 ml-2 text-slate-500"})],8,Re))),128))])):R("",!0),p.value.length<=0?(u(),f("div",Ke,Ge)):R("",!0),o("div",Qe,[t(e(w),{class:"w-32 border-slate-300 dark:border-darkmode-400 text-slate-500",onClick:a[3]||(a[3]=l=>{l.preventDefault(),X()})},{default:n(()=>[_(" Clear Items ")]),_:1})])]),_:1}),t(e(x).Panel,null,{default:n(()=>[p.value.length<=0?(u(),f("div",Xe,Je)):(u(),f("div",Ye,[o("div",Ze,[o("div",null,[et,o("div",tt,m(c.input_date),1)]),t(e(h),{icon:"Clock",class:"w-4 h-4 ml-auto text-slate-500"})]),o("div",st,[o("div",null,[at,o("div",ot,m(c.stock_name),1)]),t(e(h),{icon:"User",class:"w-4 h-4 ml-auto text-slate-500"})]),o("div",lt,[o("div",null,[nt,o("div",rt,m(c.remark),1)]),t(e(h),{icon:"Users",class:"w-4 h-4 ml-auto text-slate-500"})])]))]),_:1})]),_:1}),t(e(ee),{id:"success-notification-content",class:"flex hidden"},{default:n(()=>[t(e(h),{icon:"CheckCircle",class:"text-success"}),it]),_:1}),t(e(ee),{id:"failed-notification-content",class:"flex hidden"},{default:n(()=>[t(e(h),{icon:"XCircle",class:"text-danger"}),ct]),_:1})]),t(e(v),{open:W.value,onClsoe:a[8]||(a[8]=()=>{q(!1)}),initialFocus:j.value},{default:n(()=>[t(e(v).Panel,null,{default:n(()=>[t(e(v).Title,null,{default:n(()=>[dt]),_:1}),t(e(v).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:n(()=>[o("div",ut,[t(e(U),{htmlFor:"pos-form-1"},{default:n(()=>[_("Stock ")]),_:1}),t(e(Ce),{name:"cboAddress",modelValue:I.value,"onUpdate:modelValue":a[4]||(a[4]=l=>I.value=l),value:I.value,error:e(y).stc_code.$error,class:te({"border-danger":e(y).stc_code.$error})},{default:n(()=>[(u(!0),f(A,null,E(re.value,l=>(u(),f("option",{value:l.id,key:l.id},m(l.name),9,_t))),128))]),_:1},8,["modelValue","value","error","class"])]),o("div",mt,[t(e(U),{htmlFor:"pos-form-3"},{default:n(()=>[_("Remark")]),_:1}),t(e(se),{id:"remark",placeholder:"Item notes",modelValue:c.remark,"onUpdate:modelValue":a[5]||(a[5]=l=>c.remark=l),value:c.remark},null,8,["modelValue","value"])])]),_:1}),t(e(v).Footer,{class:"text-right"},{default:n(()=>[t(e(w),{variant:"outline-secondary",type:"button",onClick:a[6]||(a[6]=()=>{q(!1)}),class:"w-32 mr-1"},{default:n(()=>[_(" Cancel ")]),_:1}),t(e(w),{variant:"primary",type:"button",class:"w-32",ref_key:"createTicketRef",ref:j,disable:e(y).$invalid,onClick:a[7]||(a[7]=l=>de())},{default:n(()=>[_(" Create Ticket ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open","initialFocus"]),t(e(v),{open:z.value,onClsoe:a[14]||(a[14]=()=>{V(!1)}),initialFocus:G.value},{default:n(()=>[t(e(v).Panel,null,{default:n(()=>[t(e(v).Title,null,{default:n(()=>[o("h2",ft," Ticket : "+m(r.tran_code),1)]),_:1}),t(e(v).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:n(()=>[o("div",vt,[t(e(U),{htmlFor:"modal-form-3"},{default:n(()=>[_(" Qty ")]),_:1}),t(e(Z),{id:"qty",name:"qty",type:"number",placeholder:"quality",modelValue:r.qty,"onUpdate:modelValue":a[9]||(a[9]=l=>r.qty=l),value:r.qty,onKeypress:a[10]||(a[10]=l=>fe(l)),error:e(D).qty.$error,class:te({"border-danger":e(D).qty.$error})},null,8,["modelValue","value","error","class"])]),o("div",pt,[t(e(U),{htmlFor:"pos-form-5"},{default:n(()=>[_("Notes")]),_:1}),t(e(se),{id:"pos-form-5",placeholder:"Item notes",modelValue:r.remark,"onUpdate:modelValue":a[11]||(a[11]=l=>r.remark=l),value:r.remark},null,8,["modelValue","value"])])]),_:1}),t(e(v).Footer,{class:"text-right"},{default:n(()=>[t(e(w),{variant:"outline-secondary",type:"button",onClick:a[12]||(a[12]=()=>{V(!1)}),class:"w-24 mr-1"},{default:n(()=>[_(" Cancel ")]),_:1}),t(e(w),{variant:"primary",type:"button",class:"w-24",ref_key:"addItemRef",ref:G,disable:e(y).$invalid,onClick:a[13]||(a[13]=l=>{l.preventDefault(),pe()})},{default:n(()=>[_(" Add Item ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open","initialFocus"]),t(e(v),{open:K.value,onClose:a[16]||(a[16]=()=>{F(!1)})},{default:n(()=>[t(e(v).Panel,null,{default:n(()=>[o("div",ht,[t(e(h),{icon:"XCircle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),yt,kt]),o("div",bt,[t(e(w),{type:"button",variant:"primary",onClick:a[15]||(a[15]=()=>{F(!1)}),class:"w-24"},{default:n(()=>[_(" Ok ")]),_:1})])]),_:1})]),_:1},8,["open"])]))}});export{wt as default};

import{d as De,a as k,u as ie,b as qe,e as de,r as w,f as x,g as ue,o as Ve,H as ce,U as Pe,h as _,i as v,j as a,k as o,w as n,l as c,m as e,_ as q,t as Z,q as b,I as Q,F as B,s as K,v as m,A as j,V as G,n as I,W as $,C as me,D as f,z as S,L as _e,x as F,B as pe,S as X,E as U,G as A,O as T}from"./index.62cb36ac.js";const ve="http://garage_api.test/api/",Oe=De({id:"PurchaseOrderStore",state:()=>({ItemDetail:[],ItemEdit:[],Suppliers:[],UNA_PO:[],Product:[],Stock:[],SysdocDetails:[]}),getters:{getItemsById(d){return d.ItemEdit},getSupply(d){return d.Suppliers},get_una_po(d){return d.UNA_PO},getProduct(d){return d.Product},getStock(d){return d.Stock},getOrderDetail(d){return d.ItemDetail},getSysdocDetails(d){return d.SysdocDetails}},actions:{async StockActive(){await k.get("v1/pos/combo/stock_active").then(d=>{d.data.success&&(this.Stock=d.data.data)})},async SupplyActive(){await k.get("v1/pos/combo/supply_active").then(d=>{d.data.success&&(this.Suppliers=d.data.data)})},async search_items(d){await k.get(`v1/pos/search_items/${d}`).then(r=>{r.data.data.length>0&&(this.Product=r.data.data)})},async una_po_by_id(d){await k.get(`v1/pos/una_po_by_id/${d}`).then(r=>{if(r.data.success)return this.ItemEdit=r.data.data,this.ItemEdit})},async una_po_details_id(d){await k.get(`v1/pos/una_po_details_id/${d}`).then(r=>{if(r.data.success)return this.ItemDetail=r.data.data,this.ItemDetail;console.log("0000000")})},async una_po_details_sysdoc(d){await k.get(`v1/pos/una_po_sysdoc/${d}`).then(r=>{if(r.data.success)return this.SysdocDetails=r.data.data,this.SysdocDetails})},async Una_PO(){await k.get("v1/pos/una_po_list").then(d=>{if(d.data.success)return this.UNA_PO=d.data.data,this.UNA_PO})},async create_po(d){return await k.post(ve+"v1/pos/create_po",d).then(async r=>{if(r.data.success)return r.data.success}).catch(r=>{if(r.response&&r.response.data){const i=r.response.data;ie().setErrors(i.errors)}})},async create_po_details(d){return await k.post(ve+"v1/pos/create_po_details",d).then(async r=>{if(r.data.success)return r.data.success}).catch(r=>{if(r.response&&r.response.data){const i=r.response.data;ie().setErrors(i.errors)}})}}}),Ie={class:"flex flex-col items-center mt-8 intro-y sm:flex-row"},Fe=a("h2",{class:"mr-auto text-lg font-medium"},"Purchase Order",-1),Ue={class:"flex w-full mt-4 sm:w-auto sm:mt-0"},Ae={class:"flex items-center justify-center w-5 h-5"},Te={class:"truncate"},Ne={class:"grid grid-cols-12 gap-5 mt-5 intro-y"},Ee={class:"col-span-12 intro-y lg:col-span-8"},Le={class:"lg:flex intro-y"},Me={class:"relative"},Be={class:"grid grid-cols-12 gap-5 mt-5"},Ke=["onClick"],Re={class:"text-base font-medium"},We={class:"text-slate-500"},ze={class:"pr-1 intro-y"},Qe={class:"p-2 box"},je={key:0,class:"p-2 mt-5 box"},Ge=["onClick"],Xe={class:"max-w-[50%] truncate mr-1"},He={class:"text-slate-500"},Je={class:"ml-auto font-medium"},Ye={key:1,class:"p-5 mt-5 box"},Ze=a("div",{class:"flex"},[a("div",{class:"mr-auto"},"Waitting purchase order")],-1),et=[Ze],tt={class:"p-5 mt-5 box"},st={class:"flex"},at=a("div",{class:"mr-auto"},"Subtotal",-1),ot={class:"font-medium"},lt={class:"flex mt-4"},rt=a("div",{class:"mr-auto"},"Discount",-1),nt={class:"font-medium text-danger"},it={class:"flex pt-4 mt-4 border-t border-slate-200/60 dark:border-darkmode-400"},dt=a("div",{class:"mr-auto text-base font-medium"},"Total Charge",-1),ut={class:"text-base font-medium"},ct={class:"flex mt-5"},mt={class:"p-5 mt-5 box"},_t={class:"flex items-center pb-5 border-b border-slate-200 dark:border-darkmode-400"},pt=a("div",{class:"text-slate-500"},"Time",-1),vt={class:"mt-1"},ft={class:"flex items-center py-5 border-b border-slate-200 dark:border-darkmode-400"},yt=a("div",{class:"text-slate-500"},"Supply",-1),ht={class:"mt-1"},gt={class:"flex items-center py-5 border-b border-slate-200 dark:border-darkmode-400"},bt=a("div",{class:"text-slate-500"},"Invoice",-1),kt={class:"mt-1"},wt=a("div",{class:"ml-4 mr-4"},[a("div",{class:"font-medium"},"Registration success!")],-1),xt=a("div",{class:"ml-4 mr-4"},[a("div",{class:"mt-1 text-slate-500"},"Please check the fileld form.")],-1),$t=a("h2",{class:"mr-auto text-base font-medium"},"New Order",-1),St={class:"col-span-12"},Ct=["value"],Dt={class:"col-span-12"},qt={class:"col-span-12"},Vt={class:"mr-auto text-base font-medium"},Pt={class:"col-span-12 sm:col-span-6"},Ot=["value"],It={class:"col-span-12 sm:col-span-6"},Ft={class:"col-span-12 sm:col-span-6"},Ut={class:"col-span-12 sm:col-span-6"},At={class:"col-span-12 sm:col-span-6"},Tt={class:"col-span-12"},Nt={class:"p-5 text-center"},Et=a("div",{class:"mt-5 text-3xl"},"Invalid Ticket",-1),Lt=a("div",{class:"mt-2 text-slate-500"}," Please create your ticket Order first ! ",-1),Mt={class:"px-5 pb-8 text-center"},Kt=qe({__name:"PurchaseOrder",setup(d){const r=Oe(),i=de({}),l=de({}),N=w("0"),C=w("0"),V=w(""),ee=w(!1),E=u=>{ne(),ee.value=u},te=w(!1),L=u=>{l.pur_code==""||l.pur_code==null?R(!0):te.value=u};w(!1);const se=w(!1),R=u=>{se.value=u},ae=w(null),oe=w(null),fe=x(()=>({sup_code:{required:U.withMessage("Supply name is required",A),minLength:T(1)},invoice:{required:U.withMessage("Invoice is required",A),minLength:T(3)}})),y=ue(fe,i,{$autoDirty:!0});Ve(async()=>{await r.search_items("all"),await r.SupplyActive(),await r.StockActive(),await r.Una_PO(),await Y("0000"),W(),z()}),ce(N,()=>{i.sup_code=N.value}),ce(C,()=>{l.sto_code=C.value});const ye=x(()=>r.getSupply),he=x(()=>r.getStock),le=x(()=>r.get_una_po),h=x(()=>r.getItemsById),ge=x(()=>r.getProduct),P=x(()=>r.getOrderDetail),g=x(()=>r.getSysdocDetails);function H(u){return u==null||typeof u=="string"&&String(u).trim().length===0}function M(){var u=0,t=0,O=0,s=0,D=0;H(l.unitprice)?s=0:s=l.unitprice,H(l.discount)?t=0:t=l.discount,H(l.qty)?D=0:D=l.qty,O=s*D*t/100,u=s*D-O,l.amount=Number(u.toFixed(3))}function W(){i.branch_code="",i.pur_code="",i.sup_code="",i.sup_name="",i.subtotal=0,i.disamount=0,i.invoice="",i.inputter="",i.remark="",y.value.$reset(),i.status="i"}function z(){l.status="i",l.sto_code="",l.pro_code="",l.unitprice=0,l.discount=0,l.qty=1,l.amount=0,l.remark="",C.value="",p.value.$reset()}async function be(){if(y.value.$touch(),y.value.$invalid){const t=document.querySelectorAll("#failed-notification-content")[0].cloneNode(!0);t.classList.remove("hidden"),X({node:t,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast()}else{var u=await r.create_po(i);if(u){const t=document.querySelectorAll("#success-notification-content")[0].cloneNode(!0);t.classList.remove("hidden"),X({node:t,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast(),await r.Una_PO(),E(!1),W(),y.value.$reset()}}}async function re(u){await r.una_po_by_id(u),i.status="cm",h.value.length>0&&(i.pur_code=h.value[0].pur_code,i.sup_code=h.value[0].sup_code,i.sup_name=h.value[0].sup_name,i.invoice=h.value[0].invoice,i.subtotal=h.value[0].subtotal,i.disamount=h.value[0].disamount,i.input_date=h.value[0].input_date,l.status="i",l.pur_code=h.value[0].pur_code,Y(l.pur_code))}async function ke(){V.value==""||V.value==null?await r.search_items("all"):await r.search_items(V.value)}async function we(u){z(),l.pro_code=u}async function J(u){const t=["0","1","2","3","4","5","6","7","8","9","."],O=u.key;t.includes(O)||u.preventDefault()}const xe=x(()=>({sto_code:{required:U.withMessage("Stock name is required",A),minLength:T(1)},unitprice:{required:U.withMessage("Price is required",A),minLength:T(1)},discount:{required:U.withMessage("Discount is required",A),minLength:T(1)},qty:{required:U.withMessage("Qty is required",A),minLength:T(1)}})),p=ue(xe,l,{$autoDirty:!0});async function $e(){if(p.value.$touch(),M(),l.pur_code==""||l.pur_code==null)R(!0);else if(p.value.$invalid){const t=document.querySelectorAll("#failed-notification-content")[0].cloneNode(!0);t.classList.remove("hidden"),X({node:t,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast()}else{var u=await r.create_po_details(l);if(u){const t=document.querySelectorAll("#success-notification-content")[0].cloneNode(!0);t.classList.remove("hidden"),X({node:t,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast(),await r.Una_PO(),await Y(l.pur_code),E(!1),L(!1),W(),z(),y.value.$reset(),p.value.$reset(),re(l.pur_code)}}}async function Y(u){await r.una_po_details_id(u),P.value.length>0&&(l.status="i",l.pur_code=h.value[0].pur_code,C.value=P.value[0].sto_code,l.qty=P.value[0].qty)}async function Se(u){await r.una_po_details_sysdoc(u),l.status="i",l.pur_code=g.value[0].pur_code,l.pro_code=g.value[0].pro_code,l.barcode=g.value[0].barcode,l.unitprice=g.value[0].unitprice,l.qty=g.value[0].qty,l.discount=g.value[0].discount,l.disamount=g.value[0].disamount,l.amount=g.value[0].amount,l.remark=g.value[0].remark,C.value=g.value[0].sto_code,M()}function ne(){W(),z(),r.$reset(),r.search_items("all"),r.SupplyActive(),r.StockActive(),r.Una_PO()}return(u,t)=>{const O=Pe("Ri:art");return _(),v("div",null,[a("div",Ie,[Fe,a("div",Ue,[o(e(q),{id:"btnCreate",as:"a",href:"#",variant:"primary",onClick:t[0]||(t[0]=s=>{s.preventDefault(),E(!0)}),class:"mr-2 shadow-md"},{default:n(()=>[c(" New Order ")]),_:1}),le.value.length>0?(_(),Z(e(Q),{key:0,class:"ml-auto sm:ml-0"},{default:n(()=>[o(e(Q).Button,{as:e(q),class:"px-2 !box"},{default:n(()=>[a("span",Ae,[o(e(b),{icon:"ChevronDown",class:"w-4 h-4"})])]),_:1},8,["as"]),o(e(Q).Items,null,{default:n(()=>[(_(!0),v(B,null,K(le.value,s=>(_(),Z(e(Q).Item,{key:s.id,onClick:()=>{re(s.id)}},{default:n(()=>[o(e(b),{icon:"Printer",class:"w-4 h-4 mr-2"}),a("span",Te,m(s.name)+"- "+m(s.id),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):j("",!0)])]),a("div",Ne,[a("div",Ee,[a("div",Le,[a("div",Me,[o(e(I),{type:"text",modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=s=>V.value=s),value:V.value,onKeyup:t[2]||(t[2]=G(s=>ke(),["enter"])),class:"w-full px-4 py-3 pr-10 lg:w-64 !box",placeholder:"Search item..."},null,8,["modelValue","value"]),o(e(b),{icon:"Search",class:"absolute inset-y-0 right-0 w-4 h-4 my-auto mr-3 text-slate-500"})])]),a("div",Be,[(_(!0),v(B,null,K(ge.value,s=>(_(),v("div",{class:"col-span-12 p-5 cursor-pointer sm:col-span-4 2xl:col-span-3 box zoom-in",onClick:D=>{D.preventDefault(),L(!0),we(s.pro_code)},key:s.pro_code},[a("div",Re,m(s.pro_name),1),a("div",We,m(s.barcode),1)],8,Ke))),128))])]),o(e($).Group,{class:"col-span-12 lg:col-span-4"},{default:n(()=>[a("div",ze,[a("div",Qe,[o(e($).List,{variant:"pills"},{default:n(()=>[o(e($),null,{default:n(()=>[o(e($).Button,{as:"button",class:"w-full py-2"},{default:n(()=>[c(" Ticket ")]),_:1})]),_:1}),i.status=="cm"?(_(),Z(e($),{key:0},{default:n(()=>[o(e($).Button,{as:"button",class:"w-full py-2"},{default:n(()=>[c(" Details ")]),_:1})]),_:1})):j("",!0)]),_:1})])]),o(e($).Panels,null,{default:n(()=>[o(e($).Panel,null,{default:n(()=>[P.value.length>0?(_(),v("div",je,[(_(!0),v(B,null,K(P.value,(s,D)=>(_(),v("a",{href:"#",key:s.sysdoc,onClick:Ce=>{Ce.preventDefault(),L(!0),Se(s.sysdoc)},class:"flex items-center p-3 transition duration-300 ease-in-out bg-white rounded-md cursor-pointer dark:bg-darkmode-600 hover:bg-slate-100 dark:hover:bg-darkmode-400"},[a("div",Xe,m(D+1)+".",1),a("div",He,m(s.pro_name)+" - "+m(s.stc_name)+" = "+m(s.qty),1),a("div",Je,"$"+m(s.amount),1),o(e(b),{icon:"Edit",class:"w-4 h-4 ml-2 text-slate-500"})],8,Ge))),128))])):j("",!0),P.value.length<=0?(_(),v("div",Ye,et)):j("",!0),a("div",tt,[a("div",st,[at,a("div",ot,"$ "+m(i.subtotal),1)]),a("div",lt,[rt,a("div",nt," -$ "+m(i.disamount),1)]),a("div",it,[dt,a("div",ut," $ "+m(i.subtotal-i.disamount),1)])]),a("div",ct,[o(e(q),{class:"w-32 border-slate-300 dark:border-darkmode-400 text-slate-500",onClick:t[3]||(t[3]=s=>{s.preventDefault(),ne()})},{default:n(()=>[c(" Clear Items ")]),_:1})])]),_:1}),o(e($).Panel,null,{default:n(()=>[a("div",mt,[a("div",_t,[a("div",null,[pt,a("div",vt,m(i.input_date),1)]),o(e(b),{icon:"Clock",class:"w-4 h-4 ml-auto text-slate-500"})]),a("div",ft,[a("div",null,[yt,a("div",ht,m(i.sup_name),1)]),o(e(b),{icon:"User",class:"w-4 h-4 ml-auto text-slate-500"})]),a("div",gt,[a("div",null,[bt,a("div",kt,m(i.invoice),1)]),o(e(b),{icon:"Users",class:"w-4 h-4 ml-auto text-slate-500"})])])]),_:1})]),_:1})]),_:1}),o(e(me),{id:"success-notification-content",class:"flex hidden"},{default:n(()=>[o(e(b),{icon:"CheckCircle",class:"text-success"}),wt]),_:1}),o(e(me),{id:"failed-notification-content",class:"flex hidden"},{default:n(()=>[o(e(b),{icon:"XCircle",class:"text-danger"}),xt]),_:1})]),o(e(f),{open:ee.value,onClsoe:t[9]||(t[9]=()=>{E(!1)}),initialFocus:ae.value},{default:n(()=>[o(e(f).Panel,null,{default:n(()=>[o(e(f).Title,null,{default:n(()=>[$t]),_:1}),o(e(f).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:n(()=>[a("div",St,[o(e(S),{htmlFor:"pos-form-1"},{default:n(()=>[c("Supply name")]),_:1}),o(e(_e),{name:"cboAddress",modelValue:N.value,"onUpdate:modelValue":t[4]||(t[4]=s=>N.value=s),value:N.value,error:e(y).sup_code.$error,class:F({"border-danger":e(y).sup_code.$error})},{default:n(()=>[(_(!0),v(B,null,K(ye.value,s=>(_(),v("option",{value:s.id,key:s.id},m(s.name),9,Ct))),128))]),_:1},8,["modelValue","value","error","class"])]),a("div",Dt,[o(e(S),{htmlFor:"pos-form-2"},{default:n(()=>[c("Invoice")]),_:1}),o(e(I),{id:"pos-form-2",type:"text",class:F(["flex-1",{"border-danger":e(y).invoice.$error}]),placeholder:"Invoice",modelValue:i.invoice,"onUpdate:modelValue":t[5]||(t[5]=s=>i.invoice=s),value:i.invoice,error:e(y).invoice.$error},null,8,["modelValue","value","error","class"])]),a("div",qt,[o(e(S),{htmlFor:"pos-form-3"},{default:n(()=>[o(O),c("Remark")]),_:1}),o(e(pe),{id:"remark",placeholder:"item remark",modelValue:i.remark,"onUpdate:modelValue":t[6]||(t[6]=s=>i.remark=s),value:i.remark},null,8,["modelValue","value"])])]),_:1}),o(e(f).Footer,{class:"text-right"},{default:n(()=>[o(e(q),{variant:"outline-secondary",type:"button",onClick:t[7]||(t[7]=()=>{E(!1)}),class:"w-32 mr-1"},{default:n(()=>[c(" Cancel ")]),_:1}),o(e(q),{variant:"primary",type:"button",class:"w-32",ref_key:"createTicketRef",ref:ae,disable:e(y).$invalid,onClick:t[8]||(t[8]=s=>be())},{default:n(()=>[c(" Create Ticket ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open","initialFocus"]),o(e(f),{open:te.value,onClsoe:t[24]||(t[24]=()=>{L(!1)}),initialFocus:oe.value},{default:n(()=>[o(e(f).Panel,null,{default:n(()=>[o(e(f).Title,null,{default:n(()=>[a("h2",Vt," Ticket : "+m(l.pur_code),1)]),_:1}),o(e(f).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:n(()=>[a("div",Pt,[o(e(S),{htmlFor:"pos-form-1"},{default:n(()=>[c("Stock ")]),_:1}),o(e(_e),{name:"cboStock",modelValue:C.value,"onUpdate:modelValue":t[10]||(t[10]=s=>C.value=s),value:C.value,error:e(p).sto_code.$error,class:F({"border-danger":e(p).sto_code.$error})},{default:n(()=>[(_(!0),v(B,null,K(he.value,s=>(_(),v("option",{value:s.id,key:s.id},m(s.name),9,Ot))),128))]),_:1},8,["modelValue","value","error","class"])]),a("div",It,[o(e(S),{htmlFor:"modal-form-3"},{default:n(()=>[c(" Price ")]),_:1}),o(e(I),{id:"price",name:"price",type:"number",placeholder:"Price",modelValue:l.unitprice,"onUpdate:modelValue":t[11]||(t[11]=s=>l.unitprice=s),value:l.unitprice,onKeyup:t[12]||(t[12]=G(s=>M(),["enter"])),onKeypress:t[13]||(t[13]=s=>J(s)),error:e(p).unitprice.$error,class:F({"border-danger":e(p).unitprice.$error})},null,8,["modelValue","value","error","class"])]),a("div",Ft,[o(e(S),{htmlFor:"modal-form-3"},{default:n(()=>[c(" Discount ")]),_:1}),o(e(I),{id:"discount",name:"discount",type:"number",placeholder:"Discount",modelValue:l.discount,"onUpdate:modelValue":t[14]||(t[14]=s=>l.discount=s),value:l.discount,onKeyup:t[15]||(t[15]=G(s=>M(),["enter"])),onKeypress:t[16]||(t[16]=s=>J(s)),error:e(p).discount.$error,class:F({"border-danger":e(p).discount.$error})},null,8,["modelValue","value","error","class"])]),a("div",Ut,[o(e(S),{htmlFor:"modal-form-3"},{default:n(()=>[c(" Qty ")]),_:1}),o(e(I),{id:"qty",name:"qty",type:"number",placeholder:"Discount",modelValue:l.qty,"onUpdate:modelValue":t[17]||(t[17]=s=>l.qty=s),value:l.qty,onKeyup:t[18]||(t[18]=G(s=>M(),["enter"])),onKeypress:t[19]||(t[19]=s=>J(s)),error:e(p).qty.$error,class:F({"border-danger":e(p).qty.$error})},null,8,["modelValue","value","error","class"])]),a("div",At,[o(e(S),{htmlFor:"modal-form-3"},{default:n(()=>[c(" Amount ")]),_:1}),o(e(I),{id:"qty",name:"qty",type:"number",disabled:!0,placeholder:"0.00",modelValue:l.amount,"onUpdate:modelValue":t[20]||(t[20]=s=>l.amount=s),value:l.amount},null,8,["modelValue","value"])]),a("div",Tt,[o(e(S),{htmlFor:"pos-form-5"},{default:n(()=>[c("Notes")]),_:1}),o(e(pe),{id:"pos-form-5",placeholder:"Item notes",modelValue:l.remark,"onUpdate:modelValue":t[21]||(t[21]=s=>l.remark=s),value:l.remark},null,8,["modelValue","value"])])]),_:1}),o(e(f).Footer,{class:"text-right"},{default:n(()=>[o(e(q),{variant:"outline-secondary",type:"button",onClick:t[22]||(t[22]=()=>{L(!1)}),class:"w-24 mr-1"},{default:n(()=>[c(" Cancel ")]),_:1}),o(e(q),{variant:"primary",type:"button",class:"w-24",ref_key:"addItemRef",ref:oe,disable:e(y).$invalid,onClick:t[23]||(t[23]=s=>{s.preventDefault(),$e()})},{default:n(()=>[c(" Add Item ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open","initialFocus"]),o(e(f),{open:se.value,onClose:t[26]||(t[26]=()=>{R(!1)})},{default:n(()=>[o(e(f).Panel,null,{default:n(()=>[a("div",Nt,[o(e(b),{icon:"XCircle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),Et,Lt]),a("div",Mt,[o(e(q),{type:"button",variant:"primary",onClick:t[25]||(t[25]=()=>{R(!1)}),class:"w-24"},{default:n(()=>[c(" Ok ")]),_:1})])]),_:1})]),_:1},8,["open"])])}}});export{Kt as default};

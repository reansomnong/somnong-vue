import{b as le,c as ne,e as P,r as f,p as ue,o as de,f as g,H as ce,g as X,h as _,i as B,j as u,k as a,w as t,l as n,m as e,_ as w,I as F,q as D,T as r,F as O,s as R,t as E,v as p,D as c,P as I,z as j,L as ie,n as z,C as _e,E as J,G as Q,O as W}from"./index.62cb36ac.js";import{u as me}from"./Exchangerates.00c1e11d.js";const fe={class:"grid grid-cols-12 gap-6 mt-5"},pe={class:"flex flex-wrap items-center col-span-12 mt-2 intro-y sm:flex-nowrap"},ye={class:"flex items-center justify-center w-5 h-5"},ve={class:"col-span-12 overflow-auto intro-y lg:overflow-visible"},be={href:"",class:"font-medium whitespace-nowrap"},ge={class:"text-slate-500 text-xs whitespace-nowrap mt-0.5"},xe={class:"text-center"},we={class:"p-5"},he=u("h2",{class:"mr-auto text-base font-medium"}," Exchange rate ",-1),ke={class:"col-span-12 sm:col-span-6"},Te=["value"],Ce={class:"col-span-12 sm:col-span-6"},Ve={class:"col-span-12 sm:col-span-12"},$e={class:"text-center"},Be={class:"p-5"},Ae=u("h2",{class:"mr-auto text-base font-medium"}," Register VAT ",-1),Pe={class:"col-span-12 sm:col-span-6"},Fe={class:"ml-4 mr-4"},De={class:"font-medium"},Me=le({__name:"Exchangerate",setup(Ee){const d=me(),A=ne(),i=P({}),h=P({}),m=P({}),k=f("0"),S=f(!1);f(null);const y=f(""),T=f(""),x=P([]),M=f(!1),C=l=>{M.value=l},N=f(!1),V=l=>{N.value=l},G=f(),L=()=>{var l;(l=G.value)==null||l.showToast()};ue("bind[basicStickyNotification]",l=>{G.value=l}),de(async()=>{H(),ae(),await d.Base_currency_exist(),await d.ComboCurrency(),await d.ItemsList(),await d.list_VAT(),console.log(U.value),v.value.length>0&&(S.value=!0,i.amount=v.value[0].amount,i.sysdoc=v.value[0].sysdoc,k.value=v.value[0].currency_code),U.value.length>0&&(m.amount=U.value[0].amount,console.log(m.amount))});const U=g(()=>d.getVAT),v=g(()=>d.get_base_curr_exist),Y=g(()=>d.getcombo_currency),Z=g(()=>d.get_sub_currency),ee=g(()=>d.getItemsDetail);ce(k,async()=>{i.currency_code=k.value,i.currency_code!=null&&(await d.subCurrency(i.currency_code),x.splice(0),Z.value.forEach(l=>{x.push({sysdoc:l.sysdoc,currency_code:l.currency_code,currency:l.currency,amount:l.amount})}))});function H(){b.value.$reset(),i.status="i"}function ae(){$.value.$reset(),m.status="i",m.amount=0}const te=g(()=>({currency_code:{required:J.withMessage("Base currency is required",Q),minLength:W(1)}})),se=g(()=>({amount:{required:J.withMessage("VAT amount is required",Q),minLength:W(1)}})),$=X(se,m,{$autoDirty:!0}),b=X(te,i,{$autoDirty:!0});async function oe(){if(b.value.$touch(),b.value.$invalid)y.value=b.value.$errors[0].$message,T.value="error",L();else{var l=await d.create_base_currency(i);if(l){if(T.value="",i.status=="i"?y.value=A.getInsert:y.value=A.getUpdate,await d.Base_currency_exist(),v.value[0].sysdoc!=""){i.sysdoc=v.value[0].sysdoc;for(let s=0;s<x.length;s++)h.status="i",h.currency_code=x[s].currency_code,h.amount=x[s].amount,h.sysdoc=v.value[0].sysdoc,await d.create_exchange_rates(h)}C(!1),H(),await d.Base_currency_exist(),await d.ItemsList()}}}async function re(){if($.value.$touch(),$.value.$invalid)y.value=b.value.$errors[0].$message,T.value="error",L();else{var l=await d.create_vat(m);l&&(T.value="",i.status=="i"?y.value=A.getInsert:y.value=A.getUpdate,L(),V(!1),$.value.$reset())}}async function q(l){const s=["0","1","2","3","4","5","6","7","8","9","."],o=l.key;s.includes(o)||l.preventDefault()}return(l,s)=>(_(),B("div",fe,[u("div",pe,[a(e(w),{variant:"primary",class:"mr-2 shadow-md",onClick:s[0]||(s[0]=()=>{C(!0)})},{default:t(()=>[n(" Create New ")]),_:1}),a(e(F),null,{default:t(()=>[a(e(F).Button,{as:e(w),class:"px-2 !box"},{default:t(()=>[u("span",ye,[a(e(D),{icon:"Plus",class:"w-4 h-4"})])]),_:1},8,["as"]),a(e(F).Items,{class:"w-40"},{default:t(()=>[a(e(F).Item,{onClick:s[1]||(s[1]=()=>{V(!0)})},{default:t(()=>[a(e(D),{icon:"FileText",class:"w-4 h-4 mr-2"}),n("Add VAT ")]),_:1})]),_:1})]),_:1})]),u("div",ve,[a(e(r),{class:"border-spacing-y-[10px] border-separate -mt-2"},{default:t(()=>[a(e(r).Thead,null,{default:t(()=>[a(e(r).Tr,null,{default:t(()=>[a(e(r).Th,{class:"border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Base Currency ")]),_:1}),a(e(r).Th,{class:"border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Currency ")]),_:1}),a(e(r).Th,{class:"border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Exchangerates ")]),_:1}),a(e(r).Th,{class:"text-center border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Date ")]),_:1})]),_:1})]),_:1}),a(e(r).Tbody,null,{default:t(()=>[(_(!0),B(O,null,R(ee.value,o=>(_(),E(e(r).Tr,{key:o.currency_code,class:"intro-x"},{default:t(()=>[a(e(r).Td,{class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[u("a",be,p(o.base_currency),1),u("div",ge," Id:"+p(o.base_sysdoc),1)]),_:2},1024),a(e(r).Td,{class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[n(p(o.currency),1)]),_:2},1024),a(e(r).Td,{class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[n(p(o.amount),1)]),_:2},1024),a(e(r).Td,{class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[n(p(o.input_date),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),a(e(c),{staticBackdrop:"",open:M.value,onClose:s[9]||(s[9]=()=>{C(!1)})},{default:t(()=>[a(e(c).Panel,{class:"px-5 py-10"},{default:t(()=>[u("div",xe,[a(e(I),{class:"mt-5 intro-y box"},{default:t(()=>[u("div",we,[a(e(I).Panel,null,{default:t(()=>[a(e(c),{staticBackdrop:"",open:M.value,onClose:s[8]||(s[8]=()=>{C(!1)})},{default:t(()=>[a(e(c).Panel,null,{default:t(()=>[a(e(c).Title,null,{default:t(()=>[he]),_:1}),a(e(c).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:t(()=>[u("div",ke,[a(e(j),{htmlFor:"modal-form-1"},{default:t(()=>[n("Base Currency")]),_:1}),a(e(ie),{name:"cboCurrency",modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=o=>k.value=o),error:e(b).currency_code.$error,disabled:S.value,class:"focus-within:text-green-600"},{default:t(()=>[(_(!0),B(O,null,R(Y.value,o=>(_(),B("option",{value:o.id,key:o.id},p(o.name),9,Te))),128))]),_:1},8,["modelValue","error","disabled"])]),u("div",Ce,[a(e(j),{htmlFor:"modal-form-1"},{default:t(()=>[n("Value Exchange")]),_:1}),a(e(z),{name:"exchange",type:"text",disabled:S.value,modelValue:i.amount,"onUpdate:modelValue":s[3]||(s[3]=o=>i.amount=o),onKeypress:s[4]||(s[4]=o=>q(o))},null,8,["disabled","modelValue"])]),u("div",Ve,[a(e(r),{class:"border-spacing-y-[10px] border-separate -mt-2"},{default:t(()=>[a(e(r).Thead,null,{default:t(()=>[a(e(r).Tr,null,{default:t(()=>[a(e(r).Th,{class:"border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Currency ")]),_:1}),a(e(r).Th,{class:"border-b-0 whitespace-nowrap"},{default:t(()=>[n(" Value ")]),_:1})]),_:1})]),_:1}),a(e(r).Tbody,null,{default:t(()=>[(_(!0),B(O,null,R(x,o=>(_(),E(e(r).Tr,{key:o.currency_code,class:"intro-x"},{default:t(()=>[a(e(r).Td,{name:"currency_code[]",class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[n(p(o.currency),1)]),_:2},1024),a(e(r).Td,{class:"first:rounded-l-md last:rounded-r-md bg-white border-b-0 dark:bg-darkmode-600 shadow-[20px_3px_20px_#0000000b]"},{default:t(()=>[a(e(z),{name:"amount",type:"number",value:o.amount,modelValue:o.amount,"onUpdate:modelValue":K=>o.amount=K,onKeypress:s[5]||(s[5]=K=>q(K))},null,8,["value","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),_:1}),a(e(c).Footer,null,{default:t(()=>[a(e(w),{type:"button",variant:"outline-secondary",onClick:s[6]||(s[6]=()=>{C(!1)}),class:"w-20 mr-1"},{default:t(()=>[n(" Cancel ")]),_:1}),a(e(w),{name:"btnOk",variant:"primary",type:"button",class:"w-20",ref:"{sendButtonRef}",disable:e(b).$invalid,onClick:s[7]||(s[7]=o=>oe())},{default:t(()=>[n(" Commit ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})])]),_:1})])]),_:1})]),_:1},8,["open"]),a(e(c),{staticBackdrop:"",open:N.value,onClose:s[14]||(s[14]=()=>{V(!1)})},{default:t(()=>[a(e(c).Panel,{class:"px-5 py-10"},{default:t(()=>[u("div",$e,[a(e(I),{class:"mt-5 intro-y box"},{default:t(()=>[u("div",Be,[a(e(I).Panel,null,{default:t(()=>[a(e(c),{staticBackdrop:"",open:N.value,onClose:s[13]||(s[13]=()=>{V(!1)})},{default:t(()=>[a(e(c).Panel,null,{default:t(()=>[a(e(c).Title,null,{default:t(()=>[Ae]),_:1}),a(e(c).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:t(()=>[u("div",Pe,[a(e(j),{htmlFor:"modal-form-1"},{default:t(()=>[n("VAT %")]),_:1}),a(e(z),{name:"txtvat",type:"text",modelValue:m.amount,"onUpdate:modelValue":s[10]||(s[10]=o=>m.amount=o),onKeypress:s[11]||(s[11]=o=>q(o))},null,8,["modelValue"])])]),_:1}),a(e(c).Footer,null,{default:t(()=>[a(e(w),{type:"button",variant:"outline-secondary",onClick:s[12]||(s[12]=()=>{V(!1)}),class:"w-20 mr-1"},{default:t(()=>[n(" Cancel ")]),_:1}),a(e(w),{name:"btnOk",variant:"primary",type:"button",class:"w-20",ref:"{sendButtonRef}",disable:e($).$invalid,onClick:re},{default:t(()=>[n(" Commit ")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})])]),_:1})])]),_:1})]),_:1},8,["open"]),a(e(_e),{refKey:"basicStickyNotification",options:{duration:1500},class:"flex hidden"},{default:t(()=>[T.value=="error"?(_(),E(e(D),{key:0,icon:"XCircle",class:"text-danger"})):(_(),E(e(D),{key:1,icon:"CheckCircle",class:"text-success"})),u("div",Fe,[u("div",De,p(y.value),1)])]),_:1})]))}});export{Me as default};
